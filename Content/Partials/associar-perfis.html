<loading></loading>
<menu-fixed></menu-fixed>
<div class="clearfix container body" ng-controller="AssociarPerfilController">

    <div>
        <form name="usuarioPerfilForm" role="form">
            <h2>{{ titleRegister }}</h2>

            <div class="alert alert-warning" ng-show="erro" ng-cloak>
                <button type="button" class="close" ng-click="erro = undefined">&times;</button>
                <strong>Atenção!</strong> {{ erro }}
            </div>
            <div class="alert alert-success" ng-show="sucesso" ng-cloak>
                <button type="button" class="close" ng-click="sucesso = undefined">&times;</button>
                <strong>Parabéns!</strong> {{ sucesso }}
            </div>
            <div class="col-xs-12 col-md-6" ng-cloak>
                <div class="form-group">
                    <label>Usuário</label>
                    <br />
                    <span>{{ usuario.Nome }}</span>
                </div>
            </div>
            <div class="col-xs-12 col-md-6" ng-cloak>
                <div class="form-group">
                    <label>Login</label>
                    <br />
                    <span>{{ usuario.Login }}</span>
                </div>
            </div>
            <div class="col-xs-12" ng-cloak>
                <div class="form-group" ng-class="{'has-error': usuarioPerfilForm.sistema.$invalid && usuarioPerfilForm.sistema.$dirty}">
                    <label>Sistema</label>
                    <select name="sistema" ng-options="sistema.Id as sistema.Nome for sistema in sistemas" ng-change="carregarPerfis()" placeholder="Sistema" class="form-control" ng-model="sistemaId" required>
                        <option value="">-- Escolha o sistema --</option>
                    </select>
                    <span class="help-block" ng-show="usuarioPerfilForm.sistema.$error.required && usuarioPerfilForm.sistema.$dirty">Sistema é obrigatório!</span>
                </div>
            </div>
            <div class="col-xs-12 col-md-6" ng-show="sistemaId" ng-cloak>
                <ul class="list-group">
                    <li class="list-group-item header">Perfis disponíveis</li>
                    <li class="list-group-item" ng-class="{ 'removed': perfil.Removido }" ng-repeat="perfil in perfisDisponiveis track by perfil.Id+'-'+$index">
                        <a href="javascript:;" ng-click="adicionar(perfil, $index)"><i class="fa fa-lg fa-arrow-circle-right"></i></a>
                        <span>{{ perfil.Nome }}</span>
                    </li>
                    <li class="list-group-item" ng-if="!perfisDisponiveis || perfisDisponiveis.length==0">
                        <span>Nenhum perfil disponível.</span>
                    </li>
                </ul>
            </div>
            <div class="col-xs-12 col-md-6" ng-show="sistemaId" ng-cloak>
                <ul class="list-group">
                    <li class="list-group-item header">Perfis selecionados</li>
                    <li class="list-group-item" ng-class="{ 'added': perfil.Adicionado }" ng-repeat="perfil in perfisSelecionados track by perfil.Id+'-'+$index">
                        <a href="javascript:;" ng-click="remover(perfil, $index)"><i class="fa fa-lg fa-arrow-circle-left"></i></a>
                        <span>{{ perfil.Nome }}</span>
                    </li>
                    <li class="list-group-item" ng-if="!perfisSelecionados || perfisSelecionados.length==0">
                        <span>Nenhum perfil selecionado.</span>
                    </li>
                </ul>
            </div>

            <div class="col-xs-12">
                <div class="form-group">
                    <input type="button" value="Salvar" ng-click="salvar()" ng-disabled="!usuarioPerfilForm.$valid" class="btn btn-primary" />
                    <a class="btn btn-default" href="/#/usuario" role="button">Voltar</a>
                </div>
            </div>
        </form>
    </div>
</div>

